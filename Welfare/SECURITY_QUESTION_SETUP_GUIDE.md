# ë³´ì•ˆ ì§ˆë¬¸ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ ê°€ì´ë“œ

## ğŸ“‹ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### 1. ë°ì´í„°ë² ì´ìŠ¤
- âœ… `src/main/resources/schema.sql` - kindness_temperature ì»¬ëŸ¼ ì¶”ê°€, ì´ˆê¸° ë°ì´í„°ì— ë³´ì•ˆ ì§ˆë¬¸ í¬í•¨
- âœ… `fix_database_quick.sql` - ê¸°ì¡´ DBì— ë¹ ë¥´ê²Œ ì ìš©í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸

### 2. DAO Layer (ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ)
- âœ… `MemberDao.java` - findByIdAndSecurityAnswer ë©”ì„œë“œ ì¶”ê°€
- âœ… `MemberDaoImpl2.java` - MyBatis êµ¬í˜„
- âœ… `ProjectMemberDaoImpl.java` - JDBC êµ¬í˜„ (insert, select, selectList)
- âœ… `src/main/resources/mapper/MemberMapper.xml` - MyBatis SQL ë§¤í•‘

### 3. Controller Layer
- âœ… `AuthController.java` - ë³´ì•ˆ ì§ˆë¬¸ ì¡°íšŒ ë° ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • API
- âœ… `AuthApiController.java` - íšŒì›ê°€ì… ì‹œ ë³´ì•ˆ ì§ˆë¬¸ ê²€ì¦ ì¶”ê°€

### 4. View Layer
- âœ… `project_register.jsp` - íšŒì›ê°€ì… ì‹œ ë³´ì•ˆ ì§ˆë¬¸ ì…ë ¥ í•„ë“œ ì¶”ê°€
- âœ… `projectFindAccount.jsp` - 2ë‹¨ê³„ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° UI

### 5. DTO
- âœ… `Member.java` - securityQuestion, securityAnswer, kindnessTemperature í•„ë“œ ë° getter/setter

---

## ğŸš€ ì‹¤í–‰ ìˆœì„œ

### Step 1: ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸
```bash
# MySQL Workbench ë˜ëŠ” ì»¤ë§¨ë“œë¼ì¸ì—ì„œ ì‹¤í–‰
mysql -u root -p1709 springmvc < "C:\workspace\Study\Welfare\fix_database_quick.sql"
```

### Step 2: ì„œë²„ ì¬ì‹œì‘
- í†°ìº£ ì„œë²„ë¥¼ ì™„ì „íˆ ì¢…ë£Œí•˜ê³  ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.

### Step 3: í…ŒìŠ¤íŠ¸

#### (1) ê¸°ì¡´ ê³„ì • ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
1. `projectFindAccount.jsp`ë¡œ ì´ë™
2. "ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°" íƒ­ í´ë¦­
3. ì•„ì´ë”” ì…ë ¥ (ì˜ˆ: as@sd.com)
4. ë³´ì•ˆ ì§ˆë¬¸ í‘œì‹œ í™•ì¸: "ì–´ë¨¸ë‹ˆì˜ ì„±í•¨ì€?"
5. ë‹µë³€ ì…ë ¥: `ë³€ê²½í•„ìš”`
6. ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •

#### (2) ìƒˆ ê³„ì • ê°€ì…
1. íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
2. F12 â†’ Console íƒ­ ì—´ê¸°
3. ìƒˆ ì´ë©”ì¼ë¡œ ê°€ì… ì§„í–‰
4. ë³´ì•ˆ ì§ˆë¬¸ ì„ íƒ ë° ë‹µë³€ ì…ë ¥
5. ì½˜ì†” ë¡œê·¸ í™•ì¸:
   ```
   === íšŒì›ê°€ì… ë°ì´í„° ì „ì†¡ ===
   formData: {..., securityQuestion: "...", securityAnswer: "..."}
   ```
6. ì„œë²„ ë¡œê·¸(Tomcat) í™•ì¸:
   ```
   === íšŒì›ê°€ì… ìš”ì²­ ë°ì´í„° ===
   securityQuestion: ...
   securityAnswer: ...
   ```

#### (3) ìƒˆ ê³„ì •ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° í…ŒìŠ¤íŠ¸
1. ë°©ê¸ˆ ê°€ì…í•œ ê³„ì •ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° ì‹œë„
2. ë³´ì•ˆ ì§ˆë¬¸ ì •ìƒ í‘œì‹œ í™•ì¸
3. ì˜¬ë°”ë¥¸ ë‹µë³€ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„±ê³µ í™•ì¸

---

## ğŸ” ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: ë³´ì•ˆ ì§ˆë¬¸ì´ nullë¡œ ë‚˜ì˜´
**ì›ì¸**: ë°ì´í„°ë² ì´ìŠ¤ ì»¬ëŸ¼ì´ ì—†ê±°ë‚˜ ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
```sql
-- MySQLì—ì„œ ì‹¤í–‰
SELECT id, security_question, security_answer
FROM member
WHERE id = 'your_email@example.com';

-- ì—†ìœ¼ë©´ ìˆ˜ë™ ì¶”ê°€
UPDATE member
SET security_question = 'ì–´ë¨¸ë‹ˆì˜ ì„±í•¨ì€?',
    security_answer = 'í…ŒìŠ¤íŠ¸ë‹µë³€'
WHERE id = 'your_email@example.com';
```

### ë¬¸ì œ 2: íšŒì›ê°€ì… ì‹œ "ë³´ì•ˆ ì§ˆë¬¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤" ì—ëŸ¬
**ì›ì¸**: ë¸Œë¼ìš°ì €ì—ì„œ ë³´ì•ˆ ì§ˆë¬¸ì„ ì„ íƒí•˜ì§€ ì•Šì•˜ê±°ë‚˜, í¼ í•„ë“œê°€ ë¹„ì–´ìˆìŒ

**í•´ê²°**:
- ë³´ì•ˆ ì§ˆë¬¸ ë“œë¡­ë‹¤ìš´ì—ì„œ ë°˜ë“œì‹œ ì„ íƒ
- ë‹µë³€ í•„ë“œì— ë‚´ìš© ì…ë ¥

### ë¬¸ì œ 3: ì„œë²„ ë¡œê·¸ì— securityQuestion: null
**ì›ì¸**: ì„œë²„ê°€ ì¬ì‹œì‘ë˜ì§€ ì•Šì•„ ì½”ë“œ ë³€ê²½ì‚¬í•­ì´ ë°˜ì˜ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
- í†°ìº£ ì„œë²„ ì™„ì „ ì¢…ë£Œ í›„ ì¬ì‹œì‘
- ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ (Ctrl+F5)

---

## ğŸ“Š API ì—”ë“œí¬ì¸íŠ¸

### 1. ë³´ì•ˆ ì§ˆë¬¸ ì¡°íšŒ
```
GET /api/auth/security-question?username={ì´ë©”ì¼}

Response:
{
  "success": true,
  "securityQuestion": "ì–´ë¨¸ë‹ˆì˜ ì„±í•¨ì€?"
}
```

### 2. ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
```
POST /api/auth/reset-password-security
Content-Type: application/x-www-form-urlencoded

username=test@test.com&securityAnswer=ë‹µë³€&newPassword=newpass123

Response:
{
  "success": true,
  "message": "ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

### 3. íšŒì›ê°€ì…
```
POST /api/auth/register
Content-Type: application/x-www-form-urlencoded

email=new@test.com&pwd=pass123&name=í™ê¸¸ë™&phone=01012345678&securityQuestion=ì–´ë¨¸ë‹ˆì˜ ì„±í•¨ì€?&securityAnswer=ê¹€ì˜í¬

Response:
{
  "success": true,
  "message": "íšŒì›ê°€ì… ì™„ë£Œ"
}
```

---

## âœ… ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `fix_database_quick.sql` ì‹¤í–‰ ì™„ë£Œ
- [ ] ì„œë²„ ì¬ì‹œì‘ ì™„ë£Œ
- [ ] ê¸°ì¡´ ê³„ì •ìœ¼ë¡œ ë³´ì•ˆ ì§ˆë¬¸ ì¡°íšŒ ì„±ê³µ
- [ ] ê¸°ì¡´ ê³„ì •ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„±ê³µ
- [ ] ìƒˆ ê³„ì • ê°€ì… ì‹œ ë³´ì•ˆ ì§ˆë¬¸ ì…ë ¥ í•„ë“œ í™•ì¸
- [ ] ìƒˆ ê³„ì • ê°€ì… ì„±ê³µ (ë¸Œë¼ìš°ì € ì½˜ì†” ë¡œê·¸ í™•ì¸)
- [ ] ìƒˆ ê³„ì •ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° ì„±ê³µ
- [ ] ì„œë²„ ë¡œê·¸ì— ë³´ì•ˆ ì§ˆë¬¸ ë°ì´í„° ì •ìƒ ì¶œë ¥ í™•ì¸

---

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **ë¹„ë°€ë²ˆí˜¸ëŠ” í‰ë¬¸ìœ¼ë¡œ ì €ì¥ë¨**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” BCrypt ë“±ìœ¼ë¡œ ì•”í˜¸í™” í•„ìš”
2. **ë³´ì•ˆ ë‹µë³€ë„ í‰ë¬¸**: ëŒ€ì†Œë¬¸ì êµ¬ë¶„í•˜ë¯€ë¡œ ì •í™•íˆ ì…ë ¥í•´ì•¼ í•¨
3. **rate limiting ì—†ìŒ**: ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì— ì·¨ì•½ (ì¶”í›„ ê°œì„  í•„ìš”)
4. **ì´ë©”ì¼ = ID**: ì‹œìŠ¤í…œì—ì„œ ì´ë©”ì¼ì„ IDë¡œ ì‚¬ìš©í•˜ê³  ìˆìŒ

---

## ğŸ¯ ì™„ë£Œ!

ëª¨ë“  ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì„œë²„ ë¡œê·¸(Tomcat)ì™€ ë¸Œë¼ìš°ì € ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.
